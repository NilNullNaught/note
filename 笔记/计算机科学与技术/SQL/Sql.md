# 1	SQL

## 1.1	概述

##### 什么是 SQL

- 

<br>

##### SQL 的种类

- 为什么会有多种 SQL
- 常见的 SQL 种类

<br>

##### 不同 SQL 之间的区别

- 

<BR>



---

<div STYLE="page-break-after: always;"></div>

# Ⅰ	索引

## Ⅰ.0	概述

##### 什么是索引

- 

##### 索引的作用

- 

---

<div STYLE="page-break-after: always;"></div>

## Ⅰ.1	普通索引

---

<div STYLE="page-break-after: always;"></div>

## Ⅰ.2	唯一索引

---

<div STYLE="page-break-after: always;"></div>

## Ⅰ.3	主键索引

---

<div STYLE="page-break-after: always;"></div>

## Ⅰ.4	组合索引



---

<div STYLE="page-break-after: always;"></div>

## Ⅰ.5	索引实现原理

##### 最佳左前缀法则（❗待补完）

- ###### 原理

  - B-Tree

- ###### 体现

  - 将 % 放在右边将导致索引失效。
  - 创建多列联合索引时，列的顺序非常重要。B-Tree 联合索引组合顺序与创建时列的顺序是一样的，第一个字段列的顺序是确定的，其他列的顺序都是不确定的。**由于B-Tree 索引的限制，如果查询不是按照索引创建时的顺序，则无法使用索引**。<font size=1>（但是，如果在查询中 where 条件里存在联合索引的第一列，就算顺序不一致也是可以走索引的。这里是因为MySQL优化器会对查询重新排序。）</font>

<br>

##### 其他可能导致索引失效的条件

- ###### IN 与 NOT IN

  - IN 和 NOT IN 可能会导致索引失效，从而使用全表扫描。<font size=1>（MySQL优化器会选择代价最小的方式执行，IN和NOT IN 都可能索引失效，不是绝对的）</font>

- ###### IS NULL 与 IS NOT NULL

  - is null，is not null可能导致索引失效。

- ###### 未隐式转换 WHERE 后面的列

  - WHERE 后面的列要注意隐式转换，会导致索引失效。<font size=1>（比如 where value = 1024 与 where value = '1024'，由于不加单引号时，是字符串跟数字的比较，它们类型不匹配，MySQL 会进行隐式的类型转换，最后导致索引失效。）</font>


---

<div STYLE="page-break-after: always;"></div>

## 1.6	索引失效

---

<div STYLE="page-break-after: always;"></div>

# Ⅱ	通用技巧

##### SELECT 语句中应该尽量避免使用 *

- ###### 理由

  1. 不需要的列会增加数据传输时间和网络开销。
  2. 对于无用的大字段，如 varchar、blob、text，会增加 io 操作。
  3. 失去MySQL优化器“覆盖索引”策略优化的可能性。
  4. 数据表增减字段时，容易导致 resultMap 配置不一致。

<br>

##### SELECT 语句应当加上 LIMIT 限制

- ###### 理由

  1. 如果表的数据量过于巨大，不适用 LIMIT 限制可能会导致查询返回的数据量超出处理能力。
  2. 对于大量的数据，用户不可能一次性浏览完毕，将数据全部查询出来没有必要。

<br>

##### 不要过多的使用 JOIN

- ###### 理由

  1. 可以通过增加索引来优化 JOIN 语句的执行速度；
  2. 可以通过冗余信息来减少 JOIN 的次数；
  3. 尽量减少表连接的次数，一个SQL语句表连接的次数不要超过5次。

<br>

##### 表字段设计

- ###### 将表字段设为 NOT NULL

  -   因为 NULL 值很难查询优化且占用额外的索引空间，推荐默认值。

- ###### 对于表示状态的字段<font size=1>（比如 status, type 等）</font>，尽量不要定义负数

  - 不定义负数的话，就可以使用 UNSIGNED，数值容量就会扩大一倍。

- ###### 尽量使用 TINYINT、SMALLINT 代替 INT，尽量不使用 BIGINT

  - 可以减少字段占用的空间。

- ###### 尽量使用整型代替字符串

  - 字符串类型的字段会比数字类型占的空间更大，所以尽量用整型代替字符串，很多场景是可以通过编码逻辑来实现用整型代替的。

- 使用jingliang

    字符串类型长度不要随意设置，保证满足业务的前提下尽量小。

    用整型来存 IP。

    单表不要有太多字段，建议在20以内。

    为能预见的字段提前预留，因为数据量越大，修改数据结构越耗时。

  

  

---

<div STYLE="page-break-after: always;"></div>

# 附录

##### 最后编辑时间

- 2021/03/31

##### 环境

- 

##### 参考资料

- 

##### 相关资料

- 

##### 代码链接

[1]:

##### 锚点

[](#1) 

##### 脚注

[^xxx]: 